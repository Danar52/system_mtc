<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Achievement - Production System V2</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/style/style_dashb_achv.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Loading dashboard data...</p>
        </div>
    </div>

    <!-- Error Modal -->
    <div class="modal-overlay" id="errorModal">
        <div class="modal-container error">
            <div class="modal-header">
                <div class="modal-icon error-icon">
                    <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                        <circle cx="24" cy="24" r="22" stroke="currentColor" stroke-width="3"/>
                        <path d="M24 14V26M24 34V34.1" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                    </svg>
                </div>
                <h3>Error Loading Data</h3>
            </div>
            <div class="modal-body">
                <p class="error-message" id="errorMessage">-</p>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeErrorModal()">
                    <span>Close</span>
                </button>
            </div>
        </div>
    </div>

    <div class="page-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                            <rect width="32" height="32" rx="8" fill="white"/>
                            <path d="M16 8L8 12V20L16 24L24 20V12L16 8Z" stroke="black" stroke-width="2"/>
                            <path d="M16 16L8 12M16 16L24 12M16 16V24" stroke="black" stroke-width="2"/>
                        </svg>
                    </div>
                    <div class="logo-text">
                        <h1>DANDORI SYSTEM</h1>
                        <p>Production Management</p>
                    </div>
                </div>
            </div>
            <nav class="sidebar-nav">
                <a href="prod_inputdandori.html" class="nav-item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 3L3 7V13L10 17L17 13V7L10 3Z" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <span>Input Dandori</span>
                </a>
                <a href="prod_achievement.html" class="nav-item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="2" y="4" width="16" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M6 8H14M6 12H10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Input Achievement</span>
                </a>
                <a href="prod_dashb_dandori.html" class="nav-item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M3 8H17M8 3V17" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <span>Dashboard Dandori</span>
                </a>
                <a href="prod_dashb_achv.html" class="nav-item active">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="3" y="8" width="4" height="9" rx="1" stroke="currentColor" stroke-width="1.5"/>
                        <rect x="8" y="3" width="4" height="14" rx="1" stroke="currentColor" stroke-width="1.5"/>
                        <rect x="13" y="10" width="4" height="7" rx="1" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <span>Dashboard Achievement</span>
                </a>
                <a href="index.html" class="nav-item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M13 17H16C16.5523 17 17 16.5523 17 16V4C17 3.44772 16.5523 3 16 3H13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M8 13L3 10M3 10L8 7M3 10H13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Kembali ke Menu</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <div class="content-header">
                <div class="header-left">
                    <h2>Dashboard Achievement</h2>
                    <p>Analisis performa produksi berdasarkan performance score per mesin</p>
                </div>
                <div class="header-right">
                    <button class="btn-generate-report" onclick="generateFullReport()" style="display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; margin-right: 12px;">
                        <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                            <rect x="2" y="3" width="14" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M6 7H12M6 10H10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        Generate Report
                    </button>
                    <div class="info-badge">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M8 4V8L11 11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        <span class="badge-value" id="lastUpdateTime">Loading...</span>
                    </div>
                </div>
            </div>

            <!-- Filter Section -->
            <div class="filter-container">
                <div class="filter-header">
                    <div class="filter-title">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M3 6H17M5 10H15M7 14H13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        <h3>Filter Data</h3>
                    </div>
                    <button class="btn-reset" id="btnReset">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M2 8C2 4.68629 4.68629 2 8 2C11.3137 2 14 4.68629 14 8C14 11.3137 11.3137 14 8 14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M8 14L6 12M8 14L10 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        Reset Filter
                    </button>
                </div>
                <div class="filter-grid">
                    <div class="filter-field">
                        <label for="filterDateFrom" class="filter-label">
                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                                <rect x="2" y="3" width="10" height="9" rx="1" stroke="currentColor" stroke-width="1.2"/>
                                <path d="M2 5H12M4 1V3M10 1V3" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                            </svg>
                            Dari Tanggal
                        </label>
                        <input type="date" id="filterDateFrom" class="filter-input">
                    </div>
                    <div class="filter-field">
                        <label for="filterDateTo" class="filter-label">
                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                                <rect x="2" y="3" width="10" height="9" rx="1" stroke="currentColor" stroke-width="1.2"/>
                                <path d="M2 5H12M4 1V3M10 1V3" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                            </svg>
                            Sampai Tanggal
                        </label>
                        <input type="date" id="filterDateTo" class="filter-input">
                    </div>
                    <div class="filter-field">
                        <label for="filterMesin" class="filter-label">
                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                                <rect x="2" y="3" width="10" height="9" rx="1" stroke="currentColor" stroke-width="1.2"/>
                                <circle cx="7" cy="7.5" r="1.5" fill="currentColor"/>
                            </svg>
                            Nama Mesin
                        </label>
                        <select id="filterMesin" class="filter-select">
                            <option value="">Semua Mesin</option>
                        </select>
                    </div>
                    <div class="filter-field">
                        <label for="filterPartName" class="filter-label">
                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                                <rect x="2" y="2" width="10" height="10" rx="1" stroke="currentColor" stroke-width="1.2"/>
                                <path d="M5 5H9M5 7H9M5 9H7" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                            </svg>
                            Part Name
                        </label>
                        <select id="filterPartName" class="filter-select">
                            <option value="">Semua Part</option>
                        </select>
                    </div>
                    <div class="filter-field">
                        <label for="filterPartNo" class="filter-label">
                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                                <rect x="2" y="2" width="10" height="10" rx="1" stroke="currentColor" stroke-width="1.2"/>
                                <path d="M5 7H9" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                            </svg>
                            Part No
                        </label>
                        <select id="filterPartNo" class="filter-select">
                            <option value="">Semua Part No</option>
                        </select>
                    </div>
                    <div class="filter-field filter-actions">
                        <button class="btn-apply" id="btnApplyFilter">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M14 4L6 12L2 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            Terapkan Filter
                        </button>
                    </div>
                </div>
            </div>

            <!-- Key Metrics Cards -->
            <div class="metrics-overview">
                <div class="metric-card">
                    <div class="metric-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <rect x="3" y="3" width="18" height="18" rx="2" stroke="white" stroke-width="2"/>
                            <path d="M9 9H15M9 12H15M9 15H12" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <p class="metric-label">Total Records</p>
                        <h3 class="metric-value" id="metricTotalRecords">-</h3>
                        <span class="metric-subtitle">Production entries</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <circle cx="12" cy="12" r="9" stroke="white" stroke-width="2"/>
                            <path d="M12 6V12L16 14" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <p class="metric-label">Average Performance</p>
                        <h3 class="metric-value" id="metricAvgPerformance">-</h3>
                        <span class="metric-subtitle">Overall score</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" stroke="white" stroke-width="2" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <p class="metric-label">Best Machine</p>
                        <h3 class="metric-value" id="metricBestMachine">-</h3>
                        <span class="metric-subtitle" id="metricBestScore">-</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M12 2L9 8L2 9L7 14L6 21L12 18L18 21L17 14L22 9L15 8L12 2Z" stroke="white" stroke-width="2" stroke-linejoin="round"/>
                            <path d="M12 12V18" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="metric-content">
                        <p class="metric-label">Needs Attention</p>
                        <h3 class="metric-value" id="metricWorstMachine">-</h3>
                        <span class="metric-subtitle" id="metricWorstScore">-</span>
                    </div>
                </div>
            </div>

            <!-- Charts Grid -->
            <div class="charts-grid">
                <!-- Main Performance Chart -->
                <div class="chart-container chart-large">
                    <div class="chart-header">
                        <div>
                            <h4 class="chart-title">Performance Score by Machine</h4>
                            <p class="chart-subtitle">Average performance score per mesin</p>
                        </div>
                        <div class="chart-legend">
                            <span class="legend-item">
                                <span class="legend-dot" style="background: #10b981;"></span>
                                Excellent (â‰¥90%)
                            </span>
                            <span class="legend-item">
                                <span class="legend-dot" style="background: #f59e0b;"></span>
                                Good (70-89%)
                            </span>
                            <span class="legend-item">
                                <span class="legend-dot" style="background: #ef4444;"></span>
                                Needs Improvement (<70%)
                            </span>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="chartPerformanceByMachine"></canvas>
                    </div>
                </div>

                <!-- Performance Trend Chart -->
                <div class="chart-container chart-medium">
                    <div class="chart-header">
                        <div>
                            <h4 class="chart-title">Performance Trend Over Time</h4>
                            <p class="chart-subtitle">Daily average performance</p>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="chartPerformanceTrend"></canvas>
                    </div>
                </div>

                <!-- Performance Distribution -->
                <div class="chart-container chart-medium">
                    <div class="chart-header">
                        <div>
                            <h4 class="chart-title">Performance Distribution</h4>
                            <p class="chart-subtitle">Kategori performa mesin</p>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="chartPerformanceDistribution"></canvas>
                    </div>
                </div>

                <!-- Detailed Table -->
                <div class="chart-container chart-full">
                    <div class="chart-header">
                        <div>
                            <h4 class="chart-title">Detailed Performance Table</h4>
                            <p class="chart-subtitle">Breakdown per mesin dengan metrics lengkap</p>
                        </div>
                        <button class="btn-export" id="btnExport">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M8 2V10M8 10L5 7M8 10L11 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M2 12V13C2 13.5523 2.44772 14 3 14H13C13.5523 14 14 13.5523 14 13V12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Export CSV
                        </button>
                    </div>
                    <div class="chart-body">
                        <div class="table-wrapper">
                            <table class="data-table" id="performanceTable">
                                <thead>
                                    <tr>
                                        <th>Mesin</th>
                                        <th>Total Records</th>
                                        <th>Avg Performance</th>
                                        <th>Avg Qty Achievement</th>
                                        <th>Avg Eff Achievement</th>
                                        <th>Total Qty Produced</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="performanceTableBody">
                                    <tr>
                                        <td colspan="7" class="table-empty">Loading data...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="assets/js/script_dashb_achv.js"></script>
</body>
</html>